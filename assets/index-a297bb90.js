import A from"./index-9eb8ef13.js";import{f as g}from"./fabric-e75cd5cd.js";import{u as S,_ as X}from"./index-10e24cf3.js";import{r as Y,g as F,o as T,q as H,h as W,j as q,B as b,I,J as y,m as k,R as v,K as N}from"./vue-e0e31f72.js";/* empty css              */import"./arco-38a32e5c.js";function V(a){const[o,e]=a,s=o.lat,t=o.lng,n=e.lat,l=e.lng,p=6371,M=(n-s)*Math.PI/180,m=(l-t)*Math.PI/180,h=Math.sin(M/2)*Math.sin(M/2)+Math.cos(s*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2),x=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));return p*x}function $(a){const[o,e]=a,s=o.lat,t=o.lng,n=e.lat,p=(e.lng-t)*Math.PI/180,M=Math.sin(p)*Math.cos(n*Math.PI/180),m=Math.cos(s*Math.PI/180)*Math.sin(n*Math.PI/180)-Math.sin(s*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.cos(p);return(Math.atan2(M,m)*180/Math.PI+360)%360}function z(a,o){let e=0,s=0;if(a===0)s=-o;else if(a<90){const t=90-a,{opposite:n,adjacent:l}=D(o,t);e=l,s=-n}else if(a===90)e=o;else if(a>90&&a<180){const t=a-90,{opposite:n,adjacent:l}=D(o,t);e=l,s=n}else if(a===180)s=o;else if(a>180&&a<270){const t=a-180,{opposite:n,adjacent:l}=D(o,t);e=-n,s=l}else if(a===270)e=-o;else if(a>270){const t=a-270,{opposite:n,adjacent:l}=D(o,t);e=-l,s=-n}return{x:e,y:s}}function D(a,o){let e=o*(Math.PI/180),s=a*Math.sin(e),t=a*Math.cos(e);return{opposite:s,adjacent:t}}function G(a){const{origin:o,currentPoint:e,radarConfig:s}=a,{centerX:t,centerY:n,metersPerPixel:l,multiple:p}=s,M=[o,e];let{x:m,y:h}=z($(M),V(M));return m=m*1e3/(l*p)+t-5,h=h*1e3/(l*p)+n-5,{x:m,y:h}}function O(){const{$pub:a}=S(),{slBaseRandomString:o}=a,e=o(),s=o();let t=null;const n=Y({multiple:1,metersPerPixel:100,numCircles:7,minRadius:50,fontSize:16,centerX:0,centerY:0,circleColors:["#EDFCF8","#ffffff"]}),l={config:{colors:["#F66645","#FFAB07","#23BE72"]},list:[]},p=[];function M(u){a.slBasePolling(()=>m()).then(()=>{const r=m();t=new g.fabric.Canvas(s,{width:r.offsetWidth,height:r.offsetHeight,backgroundImage:u,selection:!1}),t.isDrawingMode=!1,n.value.centerX=t.getWidth()/2,n.value.centerY=t.getHeight()/2,x()})}function m(){return document.getElementById(e)}function h(){if(t){t.clear(),t=null;const u=document.getElementById(e).firstChild;u.innerHTML=`<canvas id=${s}></canvas>`}}function x(){R(),B(),L()}function R(){const{numCircles:u,minRadius:r,centerX:d,centerY:c,circleColors:C}=n.value,f=r+(u-1)*r;for(let i=u-1;i>=0;i--){const P=r+i*r;t.add(new g.fabric.Circle({radius:P,fill:i?C[i%C.length]:new g.fabric.Gradient({type:"radial",gradientUnits:"pixels",coords:{r1:r,r2:0,x1:r,y1:r,x2:r,y2:r},colorStops:[{offset:0,color:C[0]},{offset:1,color:C[1]}]}),stroke:"#C4EBDD",strokeWidth:i?1:0,strokeDashArray:i===u-1?null:[3,3],left:d-P,top:c-P,selectable:!1}))}const _={stroke:"#378C8C",strokeWidth:.5,selectable:!1,strokeDashArray:[2,2]};var w=[new g.fabric.Line([d,c-f,d,c+f],{..._,stroke:"rgba(55, 140, 140, 0.5)"}),new g.fabric.Line([d-f,c,d+f,c],{..._,stroke:"rgba(55, 140, 140, 0.5)"}),new g.fabric.Line([d-f*Math.cos(Math.PI/4),c-f*Math.sin(Math.PI/4),d+f*Math.cos(Math.PI/4),c+f*Math.sin(Math.PI/4)],{..._}),new g.fabric.Line([d+f*Math.cos(Math.PI/4),c-f*Math.sin(Math.PI/4),d-f*Math.cos(Math.PI/4),c+f*Math.sin(Math.PI/4)],{..._})];w.forEach(i=>t.add(i))}function B(){const{colors:u}=l.config,r={lng:116.40355,lat:39.923955},d=[{lng:116.44355,lat:39.933955,fill:u[0]},{lng:116.48355,lat:40.2,fill:u[0]},{lng:116.44355,lat:39.903955,fill:u[1]},{lng:116.38355,lat:39.903955,fill:u[2]},{lng:116.38355,lat:39.943955,fill:u[2]}];l.list.forEach(c=>{t.remove(c.fabricItem)}),l.list.length=0,d.forEach(c=>{const{x:C,y:f}=G({origin:r,currentPoint:c,radarConfig:n.value}),_=new g.fabric.Circle({radius:5,fill:c.fill,left:C,top:f,selectable:!1});t.add(_),l.list.push({fabricItem:_,...c})})}function L(){const{multiple:u,metersPerPixel:r,numCircles:d,minRadius:c,centerX:C,fontSize:f,centerY:_}=n.value,w=[];p.forEach(i=>{t.remove(i)}),p.length=0;for(let i=d-1;i>0;i--)w.push({x:C+c/3,y:_-c*d+(d-i)*c-c/2,text:`${c*(i+1)*r*u}m`});w.forEach(i=>{const P=new g.fabric.IText(i.text,{left:i.x,top:i.y,fontSize:f});t.add(P),p.push(P)})}function E(){n.value.multiple+=.5,L(),B()}function j(){n.value.multiple-=.5,n.value.multiple<.5&&(n.value.multiple=.5),L(),B()}return{radarConfig:n,radarReduce:j,radarAmplify:E,fabricCanvasContentId:e,fabricCanvasId:s,fabricInit:M,fabricReset:h}}const J={class:"sl-layout-content"},K={class:"flex"},U=["id"],Q=["id"],Z={__name:"index",setup(a){F();const{radarConfig:o,radarReduce:e,radarAmplify:s,fabricCanvasContentId:t,fabricCanvasId:n,fabricInit:l,fabricReset:p}=O();return T(()=>{l()}),(M,m)=>{const h=H("Button"),x=A;return W(),q("div",J,[b(x,null,{title:I(()=>[y("雷达")]),extra:I(()=>[k("div",K,[b(h,{type:"primary",onClick:v(p)},{default:I(()=>[y("重置")]),_:1},8,["onClick"]),k("div",null,[b(h,{onClick:v(s)},{default:I(()=>[y("放大")]),_:1},8,["onClick"]),b(h,null,{default:I(()=>[y(N(v(o).multiple),1)]),_:1}),b(h,{onClick:v(e)},{default:I(()=>[y("缩小")]),_:1},8,["onClick"])])])]),default:I(()=>[k("div",{class:"draw-canvas",id:v(t)},[k("canvas",{id:v(n)},null,8,Q)],8,U)]),_:1})])}}},ct=X(Z,[["__scopeId","data-v-458fc6b6"]]);export{ct as default};
